<!DOCTYPE html>
<html lang="fr"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Porte-Clé • Compte</title>
<link rel="icon" href="assets/icon.png"><link rel="stylesheet" href="assets/css/styles.css">
<script type="module">
import { $, getProgress, loadDatasets, markActive } from './assets/js/app.js';
window.addEventListener('DOMContentLoaded', async ()=>{
  markActive();
  const data = await loadDatasets(); const p = getProgress();
  const body = document.querySelector('#tbody'); let totA=0, totS=0;
  data.forEach(rule=>{
    const r = p[rule.id] || {attempts:0, success:0, last:null}; totA+=r.attempts; totS+=r.success;
    const rate = r.attempts? Math.round(100*r.success/r.attempts) : 0;
    const tr = document.createElement('tr'); tr.innerHTML = `<td>${rule.titre}</td><td>${rule.domaine}</td><td>${r.attempts}</td><td>${r.success}</td><td>${rate}%</td><td>${r.last?new Date(r.last).toLocaleDateString():"—"}</td>`;
    body.appendChild(tr);
  });
  document.querySelector('#global').textContent = (totA? Math.round(100*totS/totA) : 0) + '%';
  document.querySelector('#reset').onclick = ()=>{ if(confirm('Réinitialiser le suivi local ?')) { localStorage.removeItem('porte-cle:progress:v2'); location.reload(); } };
});
</script>
</head>
<body>
<nav class="top"><div class="inner">
<img class="logo" src="assets/icon.png" alt=""><span class="brand">Porte-Clé</span><div style="flex:1"></div>
<a href="index.html">Accueil</a><a href="theorie.html">Théorie</a><a href="exercices.html">Exercices</a><a class="active" href="compte.html">Compte</a>
</div></nav>
<main class="app">
<h1>Mon compte</h1>
<div class="kpis"><div class="kpi"><div>Taux de réussite global</div><strong id="global">—</strong></div><button id="reset" class="ghost">Réinitialiser</button></div>
<table class="table" style="margin-top:14px"><thead><tr><th>Règle</th><th>Domaine</th><th>Essais</th><th>Réussites</th><th>Réussite</th><th>Dernière</th></tr></thead><tbody id="tbody"></tbody></table>
</main>
</body></html>